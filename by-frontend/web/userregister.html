<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>用户注册</title>
    <link rel="stylesheet" href="css/public.css">
    <link rel="stylesheet" href="css/css.css">
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
<div class="top">
    <ul>
        <a href="index.html" target="_parent"><li class="down">首页<p>HOME</p></li></a>
        <a href="gamedown.html" target="_parent"><li>游戏下载<p>DOWNLOAD</p></li></a>
        <a href="recharge.html" target="_parent"><li>账户充值<p>RECHARGE</p></li></a>
        <a href="newnotice.html" target="_parent"><li>新闻公告<p>NEW NOTICE</p></li></a>
        <a href="basicdata.html" target="_parent"><li   class="down">会员中心<p>VIP</p></li></a>
        <a href="gameStr.html" target="_parent"><li>心得攻略 <p>GAME STRATEGY</p></li></a>
        <a href="servicehelp.html" target="_parent"><li>客服帮助<p>SERVICE</p></li></a>
    </ul>
</div>
<div class="box">
    <div class="zbox">
        <div class="fla-l menlef">
            <p class="p1 cor fon2">最新游戏</p>
            <div class="cen b-z cor5 fon3" id="new-gram">
                  
            </div>

            <p class="p1 cor fon2">FAQ</p>
            <div class="cen2 fon">
                <a href=""><img src="images/sy_19.png">如何下载安装游戏</a>
                <a href=""><img src="images/sy_19.png">游戏可以手机平板和电脑同时玩吗？</a>
                <a href=""><img src="images/sy_19.png">我在网站充值了钻石可以在游戏中使...</a>
                <a href=""><img src="images/sy_19.png">游戏商城中购买问题</a>
                <a href=""><img src="images/sy_19.png">积分怎么兑换</a>
                <a href=""><img src="images/sy_19.png">防沉迷生效时间</a>
                <a href=""><img src="images/sy_19.png">游戏商城中购买问题</a>
                <a href=""><img src="images/sy_19.png">积分怎么兑换</a>
                <a href="" class="no-l"><img src="images/sy_19.png">防沉迷生效时间</a>
            </div>
        </div>

        <div class="menrit fla-l">
            <p class="men-t fon2"><span class="fon-wet cor6">用户注册</span><span class="fla-r fon6 cor7">当前位置：首页>用户注册</span></p>
            <form>
                <div class="men-m fon">
                    <table>
                        <tr>
                            <td height="47px" width="97px">手机号码：</td>
                            <td><input class="inpu" id="phone"></td>
                            <td>&nbsp;&nbsp;<span class="cor3">*</span><span class="fon6">请输入11位手机号</span></td>
                        </tr>
                        <tr>
                            <td height="47px">密&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;码：</td>
                            <td><input class="inpu" type="password" id="password"></td>
                            <td>&nbsp;&nbsp;<span class="cor3">*</span><span class="fon6">密码由6-10位数字或字母组成</span></td>
                        </tr>
                        <tr>
                            <td height="47px">确认密码：</td>
                            <td><input class="inpu" type="password" id="psd-re"></td>
                            <td>&nbsp;&nbsp;<span class="cor3">*</span><span class="fon6">请再次输入密码</span></td>
                        </tr>
                        <tr>
                            <td height="47px" width="97px">昵&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;称：</td>
                            <td><input class="inpu" id="nickname"></td>
                            <td>&nbsp;&nbsp;<span class="cor3">*</span><span class="fon6">请输入2-8个中文或英文字符</span></td>
                        </tr>
                        <tr>
                            <td height="47px" width="97px">真实姓名：</td>
                            <td><input class="inpu" id="name"></td>
                            <td></td>
                        </tr>
						<tr>
                            <td height="47px" width="97px">身份证号：</td>
                            <td><input class="inpu" id="ident" required="required"></td>
                            <td>&nbsp;&nbsp;<span class="cor3">*</span><span class="fon6">请输入18位身份证号码</span></td>
                        </tr>
                        <tr>
                            <td height="47px">验&nbsp;&nbsp;证&nbsp;&nbsp;码：</td>
                            <td><input type="text" class="inpu" id="code" style="width: 120px;">&nbsp;&nbsp;&nbsp;&nbsp;<button type="button" id="sendV">发送验证码</button>&nbsp;&nbsp;<span id="count-down"></span></td>
                            <td></td>
                        </tr>
						<tr>
							<td colspan="2"><span><input type="checkbox" id="agreement" checked="checked" value="1" style="margin:auto auto"></span>&nbsp;&nbsp;我已认真阅读并同意<a href="/agreement.html" style="text-decoration: none">《用户协议》</a></td>
                        </tr>
                        <tr>
                            <td height="108px"></td>
                            <td><input class="cor txt-cen btn-sy fon2" type="button" id="confirm" value="注&nbsp;&nbsp;册"></td>
                            <td></td>
                        </tr>
                    </table>
                </div>

            </form>
        </div>
    </div>
</div>
<iframe src="bottom.html" width="100%" height="226px" frameborder="0" border="0" style="margin-top:55px;"></iframe>

<!--qq咨询-->
<div id="open">
    <img id="open-fixed" src="images/fixed_3.png" alt="">
</div>

<div id="parent">
    <div id="close-"><a id="close" href="###">X</a></div>
    <div id="ins">
        <div id="title-fixed">在线<span>QQ</span>咨询</div>
        <div id="con-fixed">
            <img src="images/bear_.png" alt="">
            <div class="qq-fixed">
                <div>联系客服</div>
                <a target="_blank" rel="nofollow" href="http://wpa.qq.com/msgrd?v=3&amp;uin=2852371661&amp;site=qq&amp;menu=yes">2852371661</a>
            </div>
        </div>
    </div>
</div>

<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.js"></script>
<script src="js/index.js"></script>

<script>
    $(function(){
        var phoneCheck=/^1[34578]\d{9}$/;
        var psdCheck=/[A-Za-z0-9]{6,10}/;
        var nickCheck=/^[\u4e00-\u9fa5a-zA-Z0-9]{2,8}$/;
		var idCheck=/^\d{17}[\d|x]$/;

        $("#confirm").click(function(){
            var nickname=$("#nickname").val();
            var phone=$("#phone").val();
            var pwd=$("#password").val();
            var repwd=$("#psd-re").val();
            var realname=$("#name").val();
			var ident=$("#ident").val();
            var code=$("#code").val();

            var phoneCheckFlag = phoneCheck.test($("#phone").val());
            var psdCheckFlag = psdCheck.test($("#password").val());
            var nicknameCheckFlag =nickCheck.test($("#nickname").val());
			var idCheckFlag = idCheck.test($("#ident").val());
			var isCheckAgreement = $("#agreement").is(":checked");
			var codeCheckFlag = code==''?true:false;

            if(!phoneCheckFlag){
                alert("手机号码格式错误");
                return false;
            }else if(!psdCheckFlag){
                alert("请输入6-10位数字或字母的密码");
                return false;
            }else if(pwd!== repwd){
                alert("两次密码输入不一致，请重新输入");
                return false;
            }else if(!nicknameCheckFlag){
                alert("昵称格式有误");
                return false;
            }else if(realname==""){
                alert("请输入您的姓名");
				return false;
			}else if(ident==""){
                alert("请输入身份证号码");
				return false;
			}else if(!idCheckFlag){
                alert("请输入正确的身份证号码");
				return false;
			}else if(!isCheckAgreement){
                alert("您尚未勾选同意用户协议");
				return false;	
			}else if(codeCheckFlag){
                alert("您还没有输入验证码");
				return false;
            }else{
                $.ajax({
                    url:'Index/reg',
                    method:'post',
                    dataType:'json',
                    data:{phone:phone,pwd:pwd,code:code,repwd:repwd,nickname:nickname,realname:realname,ident:ident},
                    success:function(res){
                        console.log(res.data);
                        if(res.result == 0){
                            alert("注册成功");
                            location.href="/index.html";
                        }else{
                            alert(res.msg)
                        }
                    },
                    error:function(res){
                        alert("发送失败")
                    }
                });
            }

        });


        $("#sendV").click(function() {
//            console.log(phoneCheck);
            var phone;
            if(phoneCheck.test($("#phone").val())) {
                phone = $("#phone").val();
            }else {
                alert("手机号格式不正确");
                return false;
            }
            var type = 1;
            $.ajax({
                url:'Index/sendSms',
                dataType:'json',
                method:'post',
                data:{'phone':phone,'type':type},
                success:function(res){
                    if(res.result==0){
                        var countDown = 60;
                        var timer = window.setInterval(function() {
                            countDown--;
                            $("#sendV").text(countDown+'s');
                            if(countDown == 0) {
                                window.clearTimeout(timer);
                                $("#count-down").text("");
                            }
                        },1000);
                        alert("验证码已经发送，请注意查收");
                    }else{
                        alert(res.msg)
                    }
                },
                error:function(res){
                    alert("验证码发送失败，后台错误")
                }
            });
        });
		
		$(function(){
            //游戏图标列表
            $.ajax({
                url: '/gameicon/list',
                dataType: 'json',
                success:function(res){
                    console.log(res);
                    if(res.result == 0){
                        var data = res.data, html = '';
                        for(var i = 0;i<data.length; i++){
                            if(i<6) {
                                html += ' <div class="mar-b">'+
                                        '<img src="'+ data[i].img_url +'" width="120px" height="120px" class="fla-l">' +
                                        '<div class="box-btn fla-l txt-cen">' +
                                        '<span class="dis">'+ data[i].name +'</span>' +
                                        '<a href="'+data[i].download_url+'" class="txt-cen fon5 cor noline">点击下载</a>' +
                                        '</div>'+
                                        '<div class="flex"></div>'+
                                        '</div>';
                            }
                        }
                        $('#new-gram').append(html);
                    }
                }
            });
        });

    })
</script>

</body>
</html>